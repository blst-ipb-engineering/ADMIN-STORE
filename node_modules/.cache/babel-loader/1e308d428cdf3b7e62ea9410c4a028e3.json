{"ast":null,"code":"import * as actionTypes from './actionTypes';\nimport axios from 'axios'; // import { Redirect } from 'react-router-dom';\n\nexport var authStart = function authStart() {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\nexport var emailValid = function emailValid(email) {\n  return {\n    type: actionTypes.EMAIL_VALID,\n    email: email\n  };\n};\nexport var emailInValid = function emailInValid() {\n  return {\n    type: actionTypes.EMAIL_INVALID\n  };\n};\nexport var authSuccess = function authSuccess(authData) {\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    authData: authData\n  };\n};\nexport var passStart = function passStart() {\n  return {\n    type: actionTypes.PASS_START\n  };\n};\nexport var passWrong = function passWrong(email) {\n  return {\n    type: actionTypes.PASS_INVALID,\n    email: email\n  };\n};\nexport var authFail = function authFail(error) {\n  return {\n    type: actionTypes.AUTH_FAIL,\n    error: error\n  };\n};\nexport var setAuthRedirectPath = function setAuthRedirectPath(path) {\n  return {\n    type: actionTypes.SET_AUTH_REDIRECT_PATH,\n    path: path\n  };\n};\nexport var logout = function logout() {\n  localStorage.removeItem('token');\n  localStorage.removeItem('expireIn');\n  localStorage.removeItem('user');\n  localStorage.removeItem('comp');\n  localStorage.removeItem('inst');\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n}; // action jika token kadaluarsa\n\nexport var auth = function auth(email) {\n  var data = {\n    email: email\n  };\n  return function (dispatch) {\n    dispatch(authStart());\n    axios.post('http://localhost:8080/auth/checkemail', data).then(function (result) {\n      if (result.data.message === \"E-mail found\") {\n        dispatch(emailValid(result.data));\n      } else {\n        dispatch(emailInValid());\n      }\n    }).catch(function (err) {\n      dispatch(authFail(err));\n    });\n  };\n};\nexport var authPassword = function authPassword(email, password) {\n  var data = {\n    email: email,\n    password: password\n  };\n  return function (dispatch) {\n    dispatch(passStart());\n    axios.post('http://localhost:8080/auth/login', data).then(function (result) {\n      if (result.data.code === 401) {\n        dispatch(passWrong(email));\n      } else {\n        var expDate = new Date(new Date().getTime() + 1000 * 60 * 60 * 10); // 10 Jam dari backend node expressnya                            \n\n        localStorage.setItem('token', result.data.token);\n        localStorage.setItem('expireIn', expDate);\n        localStorage.setItem('user', result.data.userId);\n        localStorage.setItem('comp', result.data.data.companyId);\n        localStorage.setItem('inst', result.data.data.userlevel);\n        dispatch(authSuccess(result));\n        dispatch(checkAuthTimeout(expDate));\n      }\n    }).catch(function (err) {\n      console.log(err);\n      dispatch(authFail(err));\n    });\n  };\n};\nexport var authCheckState = function authCheckState() {\n  return function (dispatch) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      dispatch(logout());\n    } else {\n      var expireTime = new Date(localStorage.getItem('expireIn'));\n\n      if (expireTime.getTime() < new Date().getTime()) {\n        dispatch(logout());\n      }\n\n      var data = {\n        data: {\n          token: localStorage.getItem('token'),\n          userId: localStorage.getItem('user'),\n          userlevel: localStorage.getItem('inst')\n        }\n      };\n      dispatch(authSuccess(data)); // dispatch(checkAuthTimeout((expireTime.getTime()) - (new Date().getTime())));\n    }\n  };\n};\nexport var checkAuthTimeout = function checkAuthTimeout(expireTime) {\n  return function (dispatch) {\n    setTimeout(function () {\n      dispatch(logout());\n    }, expireTime.getTime() / 1000);\n  };\n}; // harus install redux-thunk","map":{"version":3,"sources":["/Users/bagus/Documents/GitHub/ADMIN-STORE/src/store/action/auth.js"],"names":["actionTypes","axios","authStart","type","AUTH_START","emailValid","email","EMAIL_VALID","emailInValid","EMAIL_INVALID","authSuccess","authData","AUTH_SUCCESS","passStart","PASS_START","passWrong","PASS_INVALID","authFail","error","AUTH_FAIL","setAuthRedirectPath","path","SET_AUTH_REDIRECT_PATH","logout","localStorage","removeItem","AUTH_LOGOUT","auth","data","dispatch","post","then","result","message","catch","err","authPassword","password","code","expDate","Date","getTime","setItem","token","userId","companyId","userlevel","checkAuthTimeout","console","log","authCheckState","getItem","expireTime","setTimeout"],"mappings":"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","sourcesContent":["import * as actionTypes from './actionTypes';\nimport axios from 'axios';\n// import { Redirect } from 'react-router-dom';\n\n\nexport const authStart = () => {\n    return {\n        type: actionTypes.AUTH_START\n    };\n};\n\nexport const emailValid = (email) => {\n    return {\n        type: actionTypes.EMAIL_VALID,\n        email: email\n    };\n}\n\nexport const emailInValid = () => {\n    return {\n        type: actionTypes.EMAIL_INVALID,       \n    };\n}\n\nexport const authSuccess = (authData) => {\n    return {\n        type: actionTypes.AUTH_SUCCESS,\n        authData: authData\n    }\n}\n\nexport const passStart = () => {\n    return {\n        type: actionTypes.PASS_START\n    }\n}\n\nexport const passWrong = (email) => {\n    return {\n        type: actionTypes.PASS_INVALID,\n        email:email\n    }\n}\n\nexport const authFail = (error) => {\n    return {\n        type: actionTypes.AUTH_FAIL,\n        error : error\n    }\n}\n\nexport const setAuthRedirectPath = (path) => {\n    return {\n        type: actionTypes.SET_AUTH_REDIRECT_PATH,\n        path: path\n    }\n}\n\n\nexport const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('expireIn');\n    localStorage.removeItem('user');\n    localStorage.removeItem('comp');\n    localStorage.removeItem('inst');\n    return {\n        type: actionTypes.AUTH_LOGOUT\n    }\n}\n\n\n\n\n\n// action jika token kadaluarsa\n\nexport const auth = (email) => {\n    const data = {\n        email : email\n    }\n\n    return dispatch => {\n        dispatch(authStart());\n        axios.post('http://localhost:8080/auth/checkemail', data).then(result => {            \n            if(result.data.message === \"E-mail found\"){\n                dispatch(emailValid(result.data))\n            }else{\n                dispatch(emailInValid())\n            }\n\n        }).catch(err => {           \n            dispatch(authFail(err));\n        });\n    }\n}\n\nexport const authPassword = (email,password) =>{\n    const data= {\n        email:email,\n        password :password\n    }\n  \n\n    return dispatch => {          \n        dispatch(passStart());     \n        axios.post('http://localhost:8080/auth/login', data).then(result => {                        \n            if(result.data.code === 401){\n                dispatch(passWrong(email));\n            }else{                \n                const expDate = new Date(new Date().getTime() + 1000*60*60*10) // 10 Jam dari backend node expressnya                            \n                localStorage.setItem('token', result.data.token);\n                localStorage.setItem('expireIn', expDate);\n                localStorage.setItem('user', result.data.userId);\n                localStorage.setItem('comp', result.data.data.companyId);\n                localStorage.setItem('inst', result.data.data.userlevel);\n                dispatch(authSuccess(result));                 \n                dispatch(checkAuthTimeout(expDate));    \n\n            }\n        }).catch(err => {\n            console.log(err);\n            dispatch(authFail(err));\n        });\n    }\n};\n\nexport const authCheckState = () => {\n    return dispatch => {        \n        const token = localStorage.getItem('token');           \n        if(!token) {\n            dispatch(logout());\n        }else {\n            const expireTime = new Date(localStorage.getItem('expireIn'));                   \n            if (expireTime.getTime() < new Date().getTime()){\n                dispatch(logout());\n            }\n\n            const data = {\n                data: {\n                    token:localStorage.getItem('token'),\n                    userId:localStorage.getItem('user'),\n                    userlevel:localStorage.getItem('inst')\n                }\n            }            \n            dispatch(authSuccess(data));            \n            // dispatch(checkAuthTimeout((expireTime.getTime()) - (new Date().getTime())));\n        }\n    }\n}\n\n\nexport const checkAuthTimeout = (expireTime) => {      \n    return dispatch => {\n        setTimeout(() => { \n            dispatch(logout());\n        }, expireTime.getTime() /1000);\n    };\n};\n\n\n// harus install redux-thunk"]},"metadata":{},"sourceType":"module"}